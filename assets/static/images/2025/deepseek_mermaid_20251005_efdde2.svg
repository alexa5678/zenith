<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns:xlink="http://www.w3.org/1999/xlink" id="mermaid-svg-3" width="100%" xmlns="http://www.w3.org/2000/svg" class="flowchart" style="max-width: 100%;" viewBox="-94.17066650390626 -94.1706645965574 2071.7546630859374 3765.001245117188" role="graphics-document document" aria-roledescription="flowchart-v2" height="100%"><style>#mermaid-svg-3{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-svg-3 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-svg-3 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-svg-3 .error-icon{fill:#552222;}#mermaid-svg-3 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-3 .edge-thickness-normal{stroke-width:1px;}#mermaid-svg-3 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-3 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-3 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-svg-3 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-3 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-3 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-3 .marker.cross{stroke:#333333;}#mermaid-svg-3 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-3 p{margin:0;}#mermaid-svg-3 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-3 .cluster-label text{fill:#333;}#mermaid-svg-3 .cluster-label span{color:#333;}#mermaid-svg-3 .cluster-label span p{background-color:transparent;}#mermaid-svg-3 .label text,#mermaid-svg-3 span{fill:#333;color:#333;}#mermaid-svg-3 .node rect,#mermaid-svg-3 .node circle,#mermaid-svg-3 .node ellipse,#mermaid-svg-3 .node polygon,#mermaid-svg-3 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-3 .rough-node .label text,#mermaid-svg-3 .node .label text,#mermaid-svg-3 .image-shape .label,#mermaid-svg-3 .icon-shape .label{text-anchor:middle;}#mermaid-svg-3 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-svg-3 .rough-node .label,#mermaid-svg-3 .node .label,#mermaid-svg-3 .image-shape .label,#mermaid-svg-3 .icon-shape .label{text-align:center;}#mermaid-svg-3 .node.clickable{cursor:pointer;}#mermaid-svg-3 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-svg-3 .arrowheadPath{fill:#333333;}#mermaid-svg-3 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-3 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-3 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-svg-3 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-svg-3 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-svg-3 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-svg-3 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-3 .cluster text{fill:#333;}#mermaid-svg-3 .cluster span{color:#333;}#mermaid-svg-3 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-3 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-svg-3 rect.text{fill:none;stroke-width:0;}#mermaid-svg-3 .icon-shape,#mermaid-svg-3 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-svg-3 .icon-shape p,#mermaid-svg-3 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-svg-3 .icon-shape rect,#mermaid-svg-3 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-svg-3 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-svg-3 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-svg-3 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="mermaid-svg-3_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-svg-3_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-svg-3_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="mermaid-svg-3_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="mermaid-svg-3_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-svg-3_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"><g class="cluster" id="subGraph2" data-look="classic"><rect style="" x="8" y="1776.8889808654785" width="1164.0235137939453" height="1559.739631652832"></rect><g class="cluster-label" transform="translate(491.5742416381836, 1776.8889808654785)"><foreignObject width="196.87503051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>第三道防线: Redis 动态防御</p></span></div></foreignObject></g></g><g class="cluster" id="subGraph1" data-look="classic"><rect style="" x="1192.0235137939453" y="617.5139083862305" width="358.3377056121826" height="1332.7431297302246"></rect><g class="cluster-label" transform="translate(1293.83993434906, 617.5139083862305)"><foreignObject width="154.70486450195312" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>第二道防线: 签名验证</p></span></div></foreignObject></g></g><g class="cluster" id="subGraph0" data-look="classic"><rect style="" x="1570.361219406128" y="112.01041793823242" width="305.05209016799927" height="1190.5382690429688"></rect><g class="cluster-label" transform="translate(1656.5157358646393, 112.01041793823242)"><foreignObject width="132.74305725097656" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>第一道防线: IDC IP</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M1713.894,62.01L1713.894,66.177C1713.894,70.344,1713.894,78.677,1713.894,87.01C1713.894,95.344,1713.894,103.677,1713.964,111.427C1714.035,119.177,1714.175,126.344,1714.246,129.928L1714.316,133.511" id="L_A_B_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1714.394,284.906L1714.311,288.99C1714.228,293.073,1714.061,301.24,1714.048,308.906C1714.035,316.573,1714.175,323.74,1714.246,327.324L1714.316,330.907" id="L_B_C_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1723.805,534.593L1724.487,542.246C1725.168,549.898,1726.532,565.203,1727.214,579.024C1727.896,592.844,1727.896,605.179,1727.896,632.486C1727.896,659.794,1727.896,702.074,1727.896,746.355C1727.896,790.636,1727.896,836.918,1727.896,885.337C1727.896,933.755,1727.896,984.311,1727.896,1034.866C1727.896,1085.422,1727.896,1135.977,1727.896,1166.756C1727.896,1197.535,1727.896,1208.537,1727.896,1214.037L1727.896,1219.538" id="L_C_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1683.36,512.969L1678.49,524.226C1673.619,535.482,1663.878,557.996,1659.008,575.42C1654.137,592.844,1654.137,605.179,1619.978,626.989C1585.819,648.799,1517.502,680.084,1483.343,695.726L1449.184,711.369" id="L_C_E_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1375.527,846.694L1375.444,852.779C1375.36,858.863,1375.194,871.031,1375.185,882.7C1375.176,894.368,1375.325,905.537,1375.399,911.121L1375.474,916.705" id="L_E_F_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1417.172,1108.383L1424.564,1121.408C1431.957,1134.433,1446.743,1160.483,1479.153,1179.52C1511.562,1198.557,1561.596,1210.58,1586.613,1216.592L1611.63,1222.604" id="L_F_D_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1363.36,1137.861L1362.304,1145.973C1361.248,1154.085,1359.136,1170.309,1358.08,1183.922C1357.024,1197.535,1357.024,1208.537,1357.024,1214.037L1357.024,1219.538" id="L_F_G_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1357.024,1277.549L1357.024,1281.715C1357.024,1285.882,1357.024,1294.215,1357.024,1302.549C1357.024,1310.882,1357.024,1319.215,1357.024,1326.882C1357.024,1334.549,1357.024,1341.549,1357.024,1345.049L1357.024,1348.549" id="L_G_H_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1357.024,1406.559L1357.024,1410.726C1357.024,1414.892,1357.024,1423.226,1357.094,1430.976C1357.164,1438.726,1357.305,1445.893,1357.375,1449.476L1357.445,1453.06" id="L_H_I_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1369.969,1690.934L1370.812,1699.092C1371.655,1707.25,1373.341,1723.567,1374.184,1737.893C1375.027,1752.219,1375.027,1764.554,1375.027,1780.001C1375.027,1795.449,1375.027,1814.008,1375.027,1823.288L1375.027,1832.568" id="L_I_J_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1320.63,1666.485L1315.279,1678.718C1309.928,1690.951,1299.227,1715.417,1293.876,1733.818C1288.525,1752.219,1288.525,1764.554,1161.539,1784.201C1034.553,1803.849,780.58,1830.808,653.594,1844.288L526.608,1857.768" id="L_I_K_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M520.15,1872.436L603.292,1885.406C686.434,1898.376,852.718,1924.317,935.861,1943.454C1019.003,1962.592,1019.003,1974.927,1019.003,2003.208C1019.003,2031.49,1019.003,2075.717,1019.003,2117.944C1019.003,2160.17,1019.003,2200.396,1019.003,2245.219C1019.003,2290.043,1019.003,2339.464,1019.003,2390.886C1019.003,2442.309,1019.003,2495.732,1019.003,2546.717C1019.003,2597.702,1019.003,2646.25,1019.003,2694.797C1019.003,2743.344,1019.003,2791.892,1019.003,2826.834C1019.003,2861.776,1019.003,2883.113,1019.003,2902.449C1019.003,2921.785,1019.003,2939.12,1019.003,2968.8C1019.003,2998.48,1019.003,3040.506,1019.003,3084.532C1019.003,3128.559,1019.003,3174.586,1019.003,3203.1C1019.003,3231.615,1019.003,3242.616,1019.003,3248.117L1019.003,3253.618" id="L_K_L_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M427.831,1886.759L409.412,1897.342C390.994,1907.925,354.156,1929.091,335.737,1945.842C317.319,1962.592,317.319,1974.927,317.393,1986.679C317.467,1998.431,317.616,2009.599,317.691,2015.184L317.765,2020.768" id="L_K_M_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M317.819,2216.122L317.735,2220.205C317.652,2224.288,317.485,2232.455,317.472,2240.122C317.459,2247.789,317.6,2254.955,317.67,2258.539L317.74,2262.122" id="L_M_N_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M259.414,2454.245L245.012,2470.063C230.609,2485.882,201.805,2517.518,187.402,2552.443C173,2587.367,173,2625.579,173,2644.686L173,2663.792" id="L_N_O_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M376.223,2454.245L390.459,2470.063C404.694,2485.882,433.166,2517.518,447.476,2538.921C461.786,2560.323,461.935,2571.492,462.009,2577.076L462.084,2582.66" id="L_N_P_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M407.927,2749.724L392.702,2764.843C377.477,2779.963,347.027,2810.201,331.802,2830.821C316.576,2851.441,316.576,2862.443,316.576,2867.944L316.576,2873.445" id="L_P_Q_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M513.166,2752.906L526.078,2767.495C538.991,2782.084,564.817,2811.262,577.73,2831.351C590.643,2851.441,590.643,2862.443,590.643,2867.944L590.643,2873.445" id="L_P_R_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M590.643,2931.455L590.643,2935.622C590.643,2939.788,590.643,2948.122,590.714,2955.872C590.784,2963.622,590.924,2970.789,590.995,2974.372L591.065,2977.956" id="L_R_S_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M640.224,3135.027L653.683,3149.292C667.143,3163.556,694.062,3192.084,707.522,3211.85C720.982,3231.615,720.982,3242.616,720.982,3248.117L720.982,3253.618" id="L_S_T_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M535.52,3128.484L516.544,3143.839C497.567,3159.194,459.615,3189.903,440.639,3210.759C421.663,3231.615,421.663,3242.616,421.663,3248.117L421.663,3253.618" id="L_S_U_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M421.663,3311.629L421.663,3315.795C421.663,3319.962,421.663,3328.295,421.663,3336.629C421.663,3344.962,421.663,3353.295,454.637,3364.1C487.612,3374.904,553.56,3388.179,586.534,3394.817L619.508,3401.454" id="L_U_V_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M1019.003,3311.629L1019.003,3315.795C1019.003,3319.962,1019.003,3328.295,1019.003,3336.629C1019.003,3344.962,1019.003,3353.295,992.465,3363.543C965.927,3373.79,912.852,3385.952,886.314,3392.033L859.777,3398.114" id="L_L_V_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path><path d="M739.654,3464.649L739.654,3468.816C739.654,3472.983,739.654,3481.316,739.654,3488.983C739.654,3496.649,739.654,3503.649,739.654,3507.149L739.654,3510.649" id="L_V_W_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-svg-3_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1727.895945072174, 883.1996898651123)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1654.1372628211975, 580.5086994171143)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1494.83718, 1194.53737)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1357.0235290527344, 1186.5330600738525)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1375.0270013809204, 1739.8837718963623)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1288.5252575874329, 1739.8837718963623)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1019.0026779174805, 2694.7969932556152)"><g class="label" transform="translate(-32.005210876464844, -12.005208969116211)"><foreignObject width="64.01042175292969" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>连接失败</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(317.318603515625, 1987.2622470855713)"><g class="label" transform="translate(-32.005210876464844, -12.005208969116211)"><foreignObject width="64.01042175292969" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>连接成功</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(173.00001525878906, 2549.154623031616)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(461.63719177246094, 2549.154623031616)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(316.576416015625, 2840.4393634796143)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(590.6432762145996, 2840.4393634796143)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(720.9818267822266, 3220.612985610962)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(421.66322326660156, 3220.612985610962)"><g class="label" transform="translate(-8.003472328186035, -12.005208969116211)"><foreignObject width="16.00694465637207" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-0" transform="translate(1713.894208908081, 35.00520896911621)"><rect class="basic label-container" style="" x="-130.00001525878906" y="-27.00520896911621" width="260.0000305175781" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-100.00001525878906, -12.005208969116211)"><rect></rect><foreignObject width="200.00003051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Start: 接收到 /stream/ 请求</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B-1" transform="translate(1713.894208908081, 210.7083396911621)"><polygon points="73.69791984558105,0 147.3958396911621,-73.69791984558105 73.69791984558105,-147.3958396911621 0,-73.69791984558105" class="label-container" transform="translate(-73.19791984558105, 73.69791984558105)"></polygon><g class="label" style="" transform="translate(-46.692710876464844, -12.005208969116211)"><rect></rect><foreignObject width="93.38542175292969" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>获取客户端IP</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-C-3" transform="translate(1713.894208908081, 438.9548759460449)"><polygon points="104.54861259460449,0 209.09722518920898,-104.54861259460449 104.54861259460449,-209.09722518920898 0,-104.54861259460449" class="label-container" transform="translate(-104.04861259460449, 104.54861259460449)"></polygon><g class="label" style="" transform="translate(-77.54340362548828, -12.005208969116211)"><rect></rect><foreignObject width="155.08680725097656" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>IP是否在IDC黑名单中?</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-D-5" transform="translate(1727.895945072174, 1250.543478012085)"><rect class="basic label-container" style="fill:#f99 !important;stroke:#333 !important;stroke-width:2px !important" x="-112.51736450195312" y="-27.00520896911621" width="225.03472900390625" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-82.51736450195312, -12.005208969116211)"><rect></rect><foreignObject width="165.03472900390625" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>记录日志 &amp; Block (403)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-E-7" transform="translate(1375.0270013809204, 744.3541946411133)"><polygon points="101.84028244018555,0 203.6805648803711,-101.84028244018555 101.84028244018555,-203.6805648803711 0,-101.84028244018555" class="label-container" transform="translate(-101.34028244018555, 101.84028244018555)"></polygon><g class="label" style="" transform="translate(-62.829864501953125, -24.010417938232422)"><rect></rect><foreignObject width="125.65972900390625" height="48.020835876464844"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>提取签名参数<br/>(url, hash, token)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-F-9" transform="translate(1375.0270013809204, 1034.8663749694824)"><polygon points="114.66147422790527,0 229.32294845581055,-114.66147422790527 114.66147422790527,-229.32294845581055 0,-114.66147422790527" class="label-container" transform="translate(-114.16147422790527, 114.66147422790527)"></polygon><g class="label" style="" transform="translate(-87.65626525878906, -12.005208969116211)"><rect></rect><foreignObject width="175.31253051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>参数有效且Token未过期?</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-G-13" transform="translate(1357.0235290527344, 1250.543478012085)"><rect class="basic label-container" style="" x="-95.78125" y="-27.00520896911621" width="191.5625" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-65.78125, -12.005208969116211)"><rect></rect><foreignObject width="131.5625" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>拼接 hash + expiry</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-H-15" transform="translate(1357.0235290527344, 1379.5538959503174)"><rect class="basic label-container" style="" x="-130.00001525878906" y="-27.00520896911621" width="260.0000305175781" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-100.00001525878906, -12.005208969116211)"><rect></rect><foreignObject width="200.00003051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>FFI调用OpenSSL计算服务端签名</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-I-17" transform="translate(1357.0235290527344, 1579.7188339233398)"><polygon points="123.15972709655762,0 246.31945419311523,-123.15972709655762 123.15972709655762,-246.31945419311523 0,-123.15972709655762" class="label-container" transform="translate(-122.65972709655762, 123.15972709655762)"></polygon><g class="label" style="" transform="translate(-96.1545181274414, -12.005208969116211)"><rect></rect><foreignObject width="192.3090362548828" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>客户端签名 == 服务端签名?</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-J-19" transform="translate(1375.0270013809204, 1863.5730094909668)"><rect class="basic label-container" style="fill:#f99 !important;stroke:#333 !important;stroke-width:2px !important" x="-130.00001525878906" y="-27.00520896911621" width="260.0000305175781" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-100.00001525878906, -12.005208969116211)"><rect></rect><foreignObject width="200.00003051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>记录签名不匹配 &amp; Block (403)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-K-21" transform="translate(466.32902908325195, 1863.5730094909668)"><polygon points="61.684030532836914,0 123.36806106567383,-61.684030532836914 61.684030532836914,-123.36806106567383 0,-61.684030532836914" class="label-container" transform="translate(-61.184030532836914, 61.684030532836914)"></polygon><g class="label" style="" transform="translate(-34.6788215637207, -12.005208969116211)"><rect></rect><foreignObject width="69.3576431274414" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>连接Redis</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-L-23" transform="translate(1019.0026779174805, 3284.6234035491943)"><rect class="basic label-container" style="" x="-118.02083587646484" y="-27.00520896911621" width="236.0416717529297" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-88.02083587646484, -12.005208969116211)"><rect></rect><foreignObject width="176.0416717529297" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>记录错误, 跳过Redis检查</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-M-25" transform="translate(317.318603515625, 2119.9445419311523)"><polygon points="95.67708396911621,0 191.35416793823242,-95.67708396911621 95.67708396911621,-191.35416793823242 0,-95.67708396911621" class="label-container" transform="translate(-95.17708396911621, 95.67708396911621)"></polygon><g class="label" style="" transform="translate(-68.671875, -12.005208969116211)"><rect></rect><foreignObject width="137.34375" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>获取Visitor ID/指纹</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-N-27" transform="translate(317.318603515625, 2388.8855209350586)"><polygon points="123.26389122009277,0 246.52778244018555,-123.26389122009277 123.26389122009277,-246.52778244018555 0,-123.26389122009277" class="label-container" transform="translate(-122.76389122009277, 123.26389122009277)"></polygon><g class="label" style="" transform="translate(-96.25868225097656, -12.005208969116211)"><rect></rect><foreignObject width="192.51736450195312" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>指纹/IP/VID 是否在黑名单?</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-O-29" transform="translate(173.00001525878906, 2694.7969932556152)"><rect class="basic label-container" style="fill:#f99 !important;stroke:#333 !important;stroke-width:2px !important" x="-130.00001525878906" y="-27.00520896911621" width="260.0000305175781" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-100.00001525878906, -12.005208969116211)"><rect></rect><foreignObject width="200.00003051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>记录黑名单拦截 &amp; Block (403)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-P-31" transform="translate(461.63719177246094, 2694.7969932556152)"><polygon points="108.63715934753418,0 217.27431869506836,-108.63715934753418 108.63715934753418,-217.27431869506836 0,-108.63715934753418" class="label-container" transform="translate(-108.13715934753418, 108.63715934753418)"></polygon><g class="label" style="" transform="translate(-81.63195037841797, -12.005208969116211)"><rect></rect><foreignObject width="163.26390075683594" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>IP是否被临时限速拉黑?</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Q-33" transform="translate(316.576416015625, 2904.4497814178467)"><rect class="basic label-container" style="fill:#f99 !important;stroke:#333 !important;stroke-width:2px !important" x="-128.51564025878906" y="-27.00520896911621" width="257.0312805175781" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-98.51564025878906, -12.005208969116211)"><rect></rect><foreignObject width="197.03128051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>记录限速拦截 &amp; Block (403)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-R-35" transform="translate(590.6432762145996, 2904.4497814178467)"><rect class="basic label-container" style="" x="-79.49652862548828" y="-27.00520896911621" width="158.99305725097656" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-49.49652862548828, -12.005208969116211)"><rect></rect><foreignObject width="98.99305725097656" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>IP访问计数 +1</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-S-37" transform="translate(590.6432762145996, 3082.5313835144043)"><polygon points="101.0763931274414,0 202.1527862548828,-101.0763931274414 101.0763931274414,-202.1527862548828 0,-101.0763931274414" class="label-container" transform="translate(-100.5763931274414, 101.0763931274414)"></polygon><g class="label" style="" transform="translate(-62.065975189208984, -24.010417938232422)"><rect></rect><foreignObject width="124.13195037841797" height="48.020835876464844"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>计数是否超限?<br/>(e.g., &gt;3次/分钟)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-T-39" transform="translate(720.9818267822266, 3284.6234035491943)"><rect class="basic label-container" style="fill:#f99 !important;stroke:#333 !important;stroke-width:2px !important" x="-130.00001525878906" y="-27.00520896911621" width="260.0000305175781" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-100.00001525878906, -12.005208969116211)"><rect></rect><foreignObject width="200.00003051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>将IP加入临时黑名单 &amp; Block (403)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-U-41" transform="translate(421.66322326660156, 3284.6234035491943)"><rect class="basic label-container" style="" x="-80.67708587646484" y="-27.00520896911621" width="161.3541717529297" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-50.677085876464844, -12.005208969116211)"><rect></rect><foreignObject width="101.35417175292969" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>关闭Redis连接</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-V-43" transform="translate(739.6537017822266, 3425.639030456543)"><rect class="basic label-container" style="" x="-116.22396087646484" y="-39.01041793823242" width="232.4479217529297" height="78.02083587646484"></rect><g class="label" style="" transform="translate(-86.22396087646484, -24.010417938232422)"><rect></rect><foreignObject width="172.4479217529297" height="48.020835876464844"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Success: URL解码并设置<br/>ngx.var.decoded_url</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-W-47" transform="translate(739.6537017822266, 3541.6546573638916)"><rect class="basic label-container" style="fill:#9f9 !important;stroke:#333 !important;stroke-width:2px !important" x="-130.00001525878906" y="-27.00520896911621" width="260.0000305175781" height="54.01041793823242"></rect><g class="label" style="" transform="translate(-100.00001525878906, -12.005208969116211)"><rect></rect><foreignObject width="200.00003051757812" height="24.010417938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>End: 允许访问, Nginx继续处理</p></span></div></foreignObject></g></g></g></g></g></svg>